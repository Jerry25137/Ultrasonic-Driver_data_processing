# UD2 & UD7 Merge Files v3.1.4

本工具專為處理，漢鼎UD2系列與UD7系列超音波驅動器掃頻數據而設計，旨在 **「簡化操作流程，提升分析效率」**，可快速完成資料合併、圖表產出與共振點分析。

---

## 開發背景

1. 為協助工程端進行大量掃頻資料整合與視覺化，透過自動化合併與圖表產出，省去繁瑣的手動處理與比對。

2. 考量實際使用者多為非程式背景人員，特別設計為單一執行腳本，內建 GUI 操作介面，無需修改任何程式碼，即可直接上手。

3. 使用者只需選擇資料夾與參數，即可自動完成資料處理與報告輸出，降低學習曲線。

---

## 可以做什麼（功能總覽）

1. 內建 Tkinter GUI 圖形化操作介面，所有設定皆透過點選選單即可完成。
2. 支援匯入多筆，漢鼎UD2系列與UD7系列超音波驅動器掃頻資料（CSV、TXT 格式均可）。
3. 自動判別資料格式，區分2款超音波驅動器數據（支援電流 / 相位欄位等）。
4. 設定刀把數量、刀具數量與循環次數後，能依順序自動整併資料。
5. 產出合併後的 Excel，內含：
   - 原始資料
   - 自動產生的散佈圖（含線條樣式、顏色、線寬調整）
   - 可選擇是否產出 Current / Phase 單獨分頁，或合併圖)
6. 支援共振點分析（UD2 相位、UD7 電流）：
   - 自動計算最大點與最小點（Max/Min）
   - 使用三點法 + 距離過濾 + Prominence 邏輯篩選顯著峰值
   - 生成單獨圖表或四分圖完整展示判斷過程
7. 支援空值補線（Excel 自動補點）、Unicode 中文顯示、檔名自動命名。

---

## 怎麼用（操作方式）

1. 執行 `UD2_&_UD7_ Merge_files v3.1.4 (UI).py`
2. 點選「瀏覽」，選擇掃頻資料所在的資料夾（支援 CSV / TXT）
3. 設定：
   - 勾選要匯出的資料類型（電流 Current / 相位 Phase）
   - 是否啟用掃頻最大點分析（可調整 UD2/UD7 閾值(顯著值)條件篩選）
   - 是否要顯示共振分析圖與數據標籤
   - 刀把數量、刀具數量、循環次數（控制Excel圖表線條顏色）
   - 線條樣式（單色、實線、線寬）
5. 點選「執行」，程式會：
   - 自動讀取資料、合併
   - 計算共振點(峰值/峰谷)、分析圖表（如啟用）
   - 產出 Excel 檔（存於同一資料夾，檔名自動命名）

---

## 注意事項

1. Excel 圖表最多僅支援 255 條資料線，如超出將顯示警告，只能合併數據，並且無法生成圖表。
2. 若開啟了 Excel 檔案，儲存會失敗，請關閉後再執行。
3. 此工具尚未模組化，如需整合至大型系統建議重構封裝。

---

## 執行需求

- 作業系統：Windows
- Python 3.8 以上
- 安裝套件：
  - `tkinter`
  - `openpyxl==3.1.3`
  - `pywin32`
  - `matplotlib`

---
